CREATE TABLE gl_016_balance_by_gl (
  coa_id INT,
  bu_id INT,
  source_id INT,
  segment1_id INT,
  segment2_id INT,
  user_listing_id INT,
  approved_by_id INT,
  year_flag string,
  period_flag string,
  ey_period string,
  sys_man_ind string,
  journal_type string,
  functional_curr_cd string,
  reporting_curr_cd string,
  source_type string,
  net_reporting_amount FLOAT,
  net_reporting_amount_credit FLOAT,
  net_reporting_amount_debit FLOAT,
  net_functional_amount FLOAT,
  net_functional_amount_credit FLOAT,
  net_functional_amount_debit FLOAT,
  period_id INT,
  ey_account_type string,
  ey_account_sub_type string,
  ey_account_class string,
  ey_account_sub_class string,
  gl_account_cd string,
  gl_account_name string,
  ey_gl_account_name string,
  ey_account_group_I string,
  bu_ref string,
  bu_group string,
  year_flag_desc string,
  period_flag_desc string,
  department string,
  preparer_ref string,
  source_ref string,
  source_group string,
  segment1_ref string,
  segment2_ref string,
  segment1_group string,
  segment2_group string,
  sys_manual_ind string,
  trial_balance_start_date_id string,
  trial_balance_end_date_id string,
  Beginning_balance FLOAT,
  Ending_balance FLOAT,
  functional_beginning_balance FLOAT,
  functional_ending_balance FLOAT,
  reporting_beginning_balance FLOAT,
  reporting_ending_balance FLOAT,
  Calc_reporting_ending_bal FLOAT,
  Diff_btw_calc_end_and_report_ending FLOAT,
  Calc_functional_ending_bal FLOAT,
  Diff_btw_calc_end_and_func_ending FLOAT
)
CLUSTERED BY (coa_id, bu_id) sorted by (coa_id, bu_id) into 24 buckets
stored AS orc
;

CREATE TABLE gl_016_balance_by_gl_csv (
  coa_id INT,
  bu_id INT,
  source_id INT,
  segment1_id INT,
  segment2_id INT,
  user_listing_id INT,
  approved_by_id INT,
  year_flag string,
  period_flag string,
  ey_period string,
  sys_man_ind string,
  journal_type string,
  functional_curr_cd string,
  reporting_curr_cd string,
  source_type string,
  net_reporting_amount FLOAT,
  net_reporting_amount_credit FLOAT,
  net_reporting_amount_debit FLOAT,
  net_functional_amount FLOAT,
  net_functional_amount_credit FLOAT,
  net_functional_amount_debit FLOAT,
  period_id INT,
  ey_account_type string,
  ey_account_sub_type string,
  ey_account_class string,
  ey_account_sub_class string,
  gl_account_cd string,
  gl_account_name string,
  ey_gl_account_name string,
  ey_account_group_I string,
  bu_ref string,
  bu_group string,
  year_flag_desc string,
  period_flag_desc string,
  department string,
  preparer_ref string,
  source_ref string,
  source_group string,
  segment1_ref string,
  segment2_ref string,
  segment1_group string,
  segment2_group string,
  sys_manual_ind string,
  trial_balance_start_date_id string,
  trial_balance_end_date_id string,
  Beginning_balance FLOAT,
  Ending_balance FLOAT,
  functional_beginning_balance FLOAT,
  functional_ending_balance FLOAT,
  reporting_beginning_balance FLOAT,
  reporting_ending_balance FLOAT,
  Calc_reporting_ending_bal FLOAT,
  Diff_btw_calc_end_and_report_ending FLOAT,
  Calc_functional_ending_bal FLOAT,
  Diff_btw_calc_end_and_func_ending FLOAT
) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\054' stored AS textfile;

load data inpath '/poc/data/ey/gl_016_balance_by_gl.csv' into table gl_016_balance_by_gl_csv;

insert into table gl_016_balance_by_gl  select * from gl_016_balance_by_gl_csv;

